@import "/overlays/shared/theme.css";

/* ========================================================================== */
/* ROOT WRAPPER — fixed 1200 × 800                                            */
/* ========================================================================== */
.bb-arena-root {
  width: 1200px;
  height: 800px;
  position: relative;
  overflow: hidden;
  background: rgba(5, 5, 8, 0.75);
  border: 2px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
  box-shadow:
    0 0 40px rgba(255,77,79,0.35),
    inset 0 0 50px rgba(0,0,0,0.75);
}

/* ========================================================================== */
/* TWIST TAKEOVER                                                             */
/* ========================================================================== */
.bb-twist-takeover {
  position: absolute;
  inset: 0;
  z-index: 50;
  background: rgba(15,15,20,0.92);
  display: flex;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(12px);
  transition: opacity 0.25s ease-out;
  opacity: 0;
  pointer-events: none;
}
.bb-twist-takeover.show {
  opacity: 1;
  pointer-events: all;
  animation: bb-twist-flash 0.5s ease-out,
             bb-crt-pulse 2s infinite ease-in-out;
}
.hidden { display:none; }

/* ========================================================================== */
/* HUD — CENTER OCTAGON                                                       */
/* ========================================================================== */
.bb-hud {
  width: 350px;
  height: 350px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  clip-path: polygon(
    10% 0%, 90% 0%,
    100% 15%, 100% 85%,
    90% 100%, 10% 100%,
    0% 85%, 0% 15%
  );
  background: rgba(20,20,24,0.75);
  border: 2px solid rgba(255,255,255,0.14);
  box-shadow:
    0 0 25px rgba(0,0,0,0.8),
    inset 0 0 32px rgba(0,0,0,0.55),
    inset 0 0 22px rgba(255,77,79,0.25);
  transition: box-shadow 0.3s ease-out;
}

.hud-inner {
  position: relative;
  width: 100%;
  height: 100%;
  z-index: 5;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

/* ------------------------------------------------------ */
/* HUD TEXTS                                              */
/* ------------------------------------------------------ */
.hud-round-text {
  font-size: 38px;
  font-weight: 800;
  color: var(--bb-orange);
  text-shadow: var(--glow-hard-orange);
  margin-bottom: 4px;
}

.hud-type-text {
  font-size: 26px;
  opacity: 0.85;
  margin-bottom: 12px;
}

.hud-timer {
  font-size: 52px;
  font-weight: 900;
  color: white;
  text-shadow: var(--glow-mid-turq);
  transition: transform 0.2s ease-out;
}

/* ======================================================= */
/* HUD SHOCKWAVE — ROUND START                             */
/* ======================================================= */
.bb-hud-start {
  animation: bb-hud-shockwave 0.6s cubic-bezier(0.2, 0.9, 0.3, 1);
}

@keyframes bb-hud-shockwave {
  0% { opacity: 0.7; transform: scale(0.85); filter: blur(4px); }
  60% { opacity: 1; transform: scale(1.08); filter: blur(0); }
  100% { opacity: 1; transform: scale(1); }
}

/* ======================================================= */
/* HUD TIMER TICK                                          */
/* ======================================================= */
.bb-timer-tick {
  animation: bb-timer-tick 0.4s ease-out;
}

@keyframes bb-timer-tick {
  0% { color: white; }
  50% {
    color: var(--bb-orange);
    text-shadow: 0 0 12px var(--bb-orange);
  }
  100% { color: white; }
}

/* ========================================================================== */
/* HUD PROGRESS RING (clockwise)                                              */
/* ========================================================================== */
.hud-ring {
  position: absolute;
  top: 0;
  left: 0;
}

.hud-ring-bg {
  fill: none;
  stroke: rgba(255,255,255,0.12);
}

.hud-ring-progress {
  fill: none;
  stroke: var(--bb-orange);
  stroke-linecap: round;
  transform-origin: 50% 50%;
  transform: rotate(-90deg);
  transition: stroke-dashoffset 0.2s linear;
  filter: drop-shadow(0 0 6px rgba(255,77,79,0.9));
}

/* ========================================================================== */
/* PLAYER CARDS — 8 octagons around the center                                */
/* ========================================================================== */
#arena-players {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

/* BASE CARD */
.bb-player-card {
  width: 160px;
  height: 160px;
  position: absolute;
  clip-path: polygon(
    12% 0%, 88% 0%,
    100% 18%, 100% 82%,
    88% 100%, 12% 100%,
    0% 82%, 0% 18%
  );
  background: rgba(12,12,18,0.72);
  border: 2px solid rgba(255,255,255,0.12);
  box-shadow:
    0 0 20px rgba(0,0,0,0.65),
    inset 0 0 22px rgba(0,0,0,0.65),
    inset 0 0 14px rgba(255,77,79,0.18);
  overflow: hidden;

  display: flex;
  justify-content: center;
  align-items: flex-end;

  padding-bottom: 12px;

  /* Smooth transitions */
  transition:
    left 0.35s cubic-bezier(0.2, 0.7, 0.3, 1),
    top 0.35s cubic-bezier(0.2, 0.7, 0.3, 1),
    transform 0.35s cubic-bezier(0.2, 0.7, 0.3, 1),
    border-color 0.25s ease-out,
    box-shadow 0.25s ease-out;
}

/* BACKGROUND AVATAR (low opacity) */
.bb-player-bgavatar {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  opacity: 0.18;
  filter: blur(1px);
}

/* FOREGROUND TEXT */
.bb-player-labels {
  position: relative;
  z-index: 2;
  text-align: center;
}

.bb-player-name {
  font-size: 18px;
  font-weight: 800;
  color: white;
  margin-bottom: 4px;
  text-shadow: 0 0 8px black;
  max-width: 140px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.bb-player-score {
  font-size: 16px;
  opacity: 0.85;
  transition: transform 0.25s ease-out, color 0.25s;
}

/* POSITION BADGE */
.bb-player-pos {
  position: absolute;
  top: 4px;
  left: 4px;
  width: 32px;
  height: 32px;
  font-size: 18px;
  font-weight: 900;
  line-height: 32px;
  text-align: center;
  background: var(--bb-orange);
  color: black;
  clip-path: polygon(
    25% 0%, 75% 0%,
    100% 50%, 75% 100%,
    25% 100%, 0% 50%
  );
  text-shadow: var(--glow-soft-orange);
  z-index: 5;
}

/* ========================================================================== */
/* STATUS COLORS & EFFECTS — improved consistency                              */
/* ========================================================================== */

/* RESET helpers used in JS */
.status-alive,
.status-danger,
.status-immune,
.status-immune-broken,
.status-elimination {}

/* ACTIVE (WHITE) */
.status-alive {
  border-color: rgba(255,255,255,0.75);
  box-shadow:
    0 0 18px rgba(255,255,255,0.35),
    inset 0 0 18px rgba(255,255,255,0.22);
}

/* IMMUNE (GREEN) – pulsing glow */
.status-immune {
  border-color: #00ff99;
  box-shadow:
    0 0 22px rgba(0,255,145,0.9),
    inset 0 0 22px rgba(0,255,145,0.5);
  animation: bb-immune-glow 1.3s infinite ease-in-out;
}

@keyframes bb-immune-glow {
  0% { box-shadow: 0 0 12px rgba(0,255,150,0.7); }
  50% { box-shadow: 0 0 28px rgba(0,255,170,1); }
  100% { box-shadow: 0 0 12px rgba(0,255,150,0.7); }
}

/* IMMUNE-BROKEN — white flash alternating */
.status-immune-broken {
  animation: bb-immune-broken 0.7s infinite ease-in-out;
}

@keyframes bb-immune-broken {
  0%   { box-shadow: 0 0 14px white; border-color: white; }
  100% { box-shadow: 0 0 24px white; border-color: white; }
}

/* DANGER (ORANGE) — heartbeat pulse */
.status-danger {
  border-color: #ff8800;
  box-shadow:
    0 0 26px rgba(255,136,0,1),
    inset 0 0 26px rgba(255,136,0,0.55);
  animation: bb-danger-pulse 1.2s infinite ease-in-out;
}

@keyframes bb-danger-pulse {
  0%   { box-shadow: 0 0 16px rgba(255,140,40,0.7); }
  50%  { box-shadow: 0 0 30px rgba(255,160,40,1); }
  100% { box-shadow: 0 0 16px rgba(255,140,40,0.7); }
}

/* ELIMINATION (RED) — explosion collapse */
.status-elimination {
  border-color: #ff0033;
  box-shadow:
    0 0 32px rgba(255,0,51,0.9),
    inset 0 0 32px rgba(255,0,51,0.55);
  animation: bb-elim-explode 0.55s forwards cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes bb-elim-explode {
  0%   { transform: scale(1); filter: brightness(1); opacity: 1; }
  30%  { transform: scale(1.25); filter: brightness(2); opacity: 1; }
  100% { transform: scale(0.35); filter: brightness(0.6); opacity: 0.2; }
}

/* ========================================================================== */
/* PLAYER JOIN ANIMATION                                                      */
/* ========================================================================== */
.bb-player-card.join-anim {
  animation: bb-join-pop 0.45s cubic-bezier(0.25, 1.15, 0.3, 1.1);
}

@keyframes bb-join-pop {
  0%   { transform: scale(0) rotate(var(--rot)); opacity: 0; }
  60%  { transform: scale(1.2) rotate(var(--rot)); opacity: 1; }
  100% { transform: scale(1)   rotate(var(--rot)); }
}

/* ========================================================================== */
/* SCORE FLASH (gift received)                                                */
/* ========================================================================== */
.bb-score-anim {
  animation: bb-score-flash 0.35s ease-out;
}

@keyframes bb-score-flash {
  0%   { color: white; transform: scale(1); }
  50%  { color: gold;  transform: scale(1.32); }
  100% { color: white; transform: scale(1); }
}

/* ========================================================================== */
/* PLAYER POSITIONS — radiaal rond de HUD                                      */
/* ========================================================================== */

:root {
  --cx: 600px;       /* center X van 1200px */
  --cy: 400px;       /* center Y van 800px */
  --radius: 300px;   /* afstand van het centrum */
}

/*
  Let op:
  - Rotatie wordt in JS toegepast (CSS calc combineert niet met rotate)
  - Daarom alleen translate hier
*/

.bb-p1 { transform: translate(calc(var(--cx) + var(--radius) * 0.7071 - 80px), calc(var(--cy) - var(--radius) * 0.7071 - 80px)); }
.bb-p2 { transform: translate(calc(var(--cx) + var(--radius) - 80px),       calc(var(--cy) - 80px)); }
.bb-p3 { transform: translate(calc(var(--cx) + var(--radius) * 0.7071 - 80px), calc(var(--cy) + var(--radius) * 0.7071 - 80px)); }
.bb-p4 { transform: translate(calc(var(--cx) - 80px),                         calc(var(--cy) + var(--radius) - 80px)); }
.bb-p5 { transform: translate(calc(var(--cx) - var(--radius) * 0.7071 - 80px), calc(var(--cy) + var(--radius) * 0.7071 - 80px)); }
.bb-p6 { transform: translate(calc(var(--cx) - var(--radius) - 80px),         calc(var(--cy) - 80px)); }
.bb-p7 { transform: translate(calc(var(--cx) - var(--radius) * 0.7071 - 80px), calc(var(--cy) - var(--radius) * 0.7071 - 80px)); }
.bb-p8 { transform: translate(calc(var(--cx) - 80px),                         calc(var(--cy) - var(--radius) - 80px)); }

/* ========================================================================== */
/* HUD — ROUND START SHOCKWAVE                                                */
/* ========================================================================== */
@keyframes bb-hud-shockwave {
  0%   { opacity: 0.6; transform: scale(0.8); filter: blur(4px); }
  60%  { opacity: 1;   transform: scale(1.1); filter: blur(0); }
  100% { opacity: 1;   transform: scale(1);   }
}

.bb-hud-start {
  animation: bb-hud-shockwave 0.6s cubic-bezier(0.2, 0.9, 0.3, 1);
}

/* ========================================================================== */
/* HUD TIMER TICK (elke seconde)                                              */
/* ========================================================================== */
@keyframes bb-timer-tick {
  0%   { color: white; }
  50%  { color: var(--bb-orange); text-shadow: 0 0 12px var(--bb-orange); }
  100% { color: white; }
}

.bb-timer-tick {
  animation: bb-timer-tick 0.4s ease-out;
}

/* ========================================================================== */
/* TWIST TAKEOVER — full-screen neon flash                                     */
/* ========================================================================== */

.bb-twist-takeover {
  position: absolute;
  inset: 0;
  z-index: 50;
  background: rgba(15,15,20,0.92);
  display: flex;
  justify-content: center;
  align-items: center;

  backdrop-filter: blur(12px);

  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease-out;
}

.bb-twist-takeover.show {
  opacity: 1;
  pointer-events: all;
  animation: bb-twist-flash 0.55s ease-out;
}

@keyframes bb-twist-flash {
  0%   { opacity: 0;   filter: brightness(0.3); }
  50%  { opacity: 1;   filter: brightness(3); }
  100% { opacity: 1;   filter: brightness(1.2); }
}

/* Continuous CRT pulse while active */
@keyframes bb-crt-pulse {
  0%   { opacity: 1; }
  50%  { opacity: 0.87; }
  100% { opacity: 1; }
}

.bb-twist-takeover.show {
  animation: bb-twist-flash 0.55s ease-out, bb-crt-pulse 2s infinite ease-in-out;
}

/* ========================================================================== */
/* SMOOTH TRANSITIONS FOR CARD POSITIONING                                     */
/* ========================================================================== */
.bb-player-card {
  transition:
    left 0.35s cubic-bezier(0.2, 0.7, 0.3, 1),
    top 0.35s cubic-bezier(0.2, 0.7, 0.3, 1),
    transform 0.35s cubic-bezier(0.2, 0.7, 0.3, 1),
    border-color 0.25s ease-out,
    box-shadow 0.25s ease-out;
}

/* ========================================================================== */
/* OPTIONAL: card hover (disabled in OBS but useful for debugging)            */
/* ========================================================================== */
.bb-player-card:hover {
  filter: brightness(1.15);
}
